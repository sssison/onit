services:
  onit-mcp:
    build: .
    ports:
      - "18200:18200"
      - "18201:18201"
      - "18202:18202"
      - "18203:18203"
      - "18204:18204"
    env_file: .env
    command: ["--mcp"]

  onit-web:
    build: .
    ports:
      - "9000:9000"
    env_file: .env
    depends_on:
      - onit-mcp
    volumes:
      - web-sessions:/root/.onit/sessions
    command: ["--web", "--web-port", "9000", "--mcp-host", "onit-mcp"]

  onit-a2a:
    build: .
    ports:
      - "9001:9001"
    env_file: .env
    depends_on:
      - onit-mcp
    volumes:
      - a2a-sessions:/root/.onit/sessions
    command: ["--a2a", "--a2a-port", "9001", "--mcp-host", "onit-mcp"]

  onit-gateway:
    build: .
    env_file: .env
    depends_on:
      - onit-mcp
    volumes:
      - gateway-sessions:/root/.onit/sessions
    command: ["--gateway", "--mcp-host", "onit-mcp"]

volumes:
  web-sessions:
  a2a-sessions:
  gateway-sessions:
